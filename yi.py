# coding=utf-8
import tkinter as tk
import random
import time

# 易經六十四卦的名稱對應表（下卦與上卦）
TRIGRAM_NAMES = {
    "111": "乾", "000": "坤", "100": "震", "011": "巽", "010": "坎",
    "001": "艮", "101": "離", "110": "兌"
}

# 卦象編號對應表，代表每個六十四卦的編號
HEXAGRAM_NAMES = {
    "111111": "乾卦",
    "000000": "坤卦",
    "010001": "屯卦",
    "100010": "蒙卦",
    "010111": "需卦",
    "111010": "訟卦",
    "000010": "師卦",
    "010000": "比卦",
    "110111": "小畜卦",
    "111011": "履卦",
    "000111": "泰卦",
    "111000": "否卦",
    "111101": "同人卦",
    "101111": "大有卦",
    "000100": "謙卦",
    "001000": "豫卦",
    "011001": "隨卦",
    "100110": "蠱卦",
    "000011": "臨卦",
    "110000": "觀卦",
    "101001": "噬嗑卦",
    "100101": "賁卦",
    "100000": "剝卦",
    "000001": "復卦",
    "111001": "無妄卦",
    "100111": "大畜卦",
    "100001": "頤卦",
    "011110": "大過卦",
    "010010": "坎卦",
    "101101": "離卦",
    "011100": "咸卦",
    "001110": "恆卦",
    "111100": "遯卦",
    "001111": "大壯卦",
    "101000": "晉卦",
    "000101": "明夷卦",
    "110101": "家人卦",
    "101011": "睽卦",
    "010100": "蹇卦",
    "001010": "解卦",
    "100011": "損卦",
    "110001": "益卦",
    "011111": "夬卦",
    "111110": "姤卦",
    "011000": "萃卦",
    "000110": "升卦",
    "011010": "困卦",
    "010110": "井卦",
    "011101": "革卦",
    "101110": "鼎卦",
    "001001": "震卦",
    "100100": "艮卦",
    "110100": "漸卦",
    "001011": "歸妹卦",
    "001101": "豐卦",
    "101100": "旅卦",
    "110110": "巽卦",
    "011011": "兌卦",
    "110010": "渙卦",
    "010011": "節卦",
    "110011": "中孚卦",
    "001100": "小過卦",
    "010101": "既濟卦",
    "101010": "未濟卦",
}
# 卦象解析
HEXAGRAM_INTERPRETATIONS = {
  "乾卦": "第1卦 乾為天（幹）\n剛健中正 上上卦\n象曰：困龍得水好運交，不由喜氣上眉梢，一切謀望皆如意，向後時運漸漸高。\n這個卦是同卦（下乾上乾）相疊。象徵天，喻龍（德才的君子），又像徵純粹的陽和健，顯示興盛強健。乾卦是根據萬物變通的道理，以「元、亨、利、貞」 為卦辭，示吉祥如意，教導人遵守天道的德行。",
  "坤卦": "第2卦 坤為地（坤）\n柔軟伸展 上上卦\n象曰：肥羊失群入山崗，餓虎逢之把口張，適口充腸心歡喜，卦若佔之大吉昌。\n這個卦是同卦（下坤上坤）相疊，陰性。象徵地（與乾卦相反），順從天。承載萬物，伸展無窮無盡。坤卦以雌馬為象徵，顯示地道生育撫養萬物，而又依天順時，性情溫順。\n它以“先迷後得”證明“坤”順從“幹”，依隨“幹”，才能把握正確方向，遵循正道，獲取吉利。",
  "屯卦": "第3卦 水雷屯（屯）\n起始維艱 下卦\n象曰：風刮亂絲不見頭，顛倒四犯憂愁，慢從款來左順遂，急促反惹不自由。\n這個卦是異卦（下震上坎）相疊，震為雷，喻動；坎為雨，喻險。雷雨交加，險象叢生，環境惡劣。 「屯」原指植物萌生大地。萬物始生，充滿艱難險阻，然而順時應運，必欣欣向榮。",
  "蒙卦": "第4卦 山水蒙（蒙）\n啟蒙奮發 中下卦\n象曰：卦中爻象犯小耗，君子佔之運不高，婚姻合夥有瑣碎，做事必然受苦勞。\n這個卦是異卦（下坎上根）相疊，根是山的形象，喻止；坎是水的形象，喻險。卦形為山下有險，仍不停止前進，是為蒙昧，故稱蒙卦。但因把握時機，行動切合時宜，因此，具有啟蒙和通達的卦象。",
  "需卦": "第5卦 水天需（需）\n\
守正待機 中上卦\n\
象曰：明珠土埋日久深，無光無亮到如今，忽然大風吹土去，自然顯露有重新。\n\
這個卦是異卦（下乾上坎）相疊，下卦是乾，剛健之意；上卦是坎，險陷之意。以剛逢險，宜穩健之妥，不可冒失行動，觀時待變，所往一定成功。",
  "訟卦": "第6卦 天水訟（訟）\n\
謹慎戒訟 中下卦\n\
象曰：心中有事難做，恰是二人爭路走，雨下俱是要佔先，誰肯讓誰走一步。\n\
這個卦是異卦（下坎上乾）相疊。同需卦相反，互為「綜卦」。乾為剛健，坎為險陷。剛與險，健與險，彼此反對，定生爭訟。爭訟非善事，務必謹慎戒懼。",
  "師卦": "第7卦 地水師（師）\n\
行險而順 中上卦\n\
象曰：將帥領旨去出征，騎著烈馬拉硬弓，百步穿楊去得準，箭中金錢喜氣生。\n\
這個卦是異卦（下坎上坤）相疊。 「師」指軍隊。坎為水、為險；坤為地、為順，喻寓兵於農。兵兇戰危，用兵乃聖人不得已而為之，\n但它可以順利無阻礙地解決矛盾，因為順乎形勢，師出有名，故能化兇為吉。",
  "比卦": "第8卦 水地比（比）\n\
誠信團結 上上卦\n\
象曰：順風行船撒起帆，上天又助一蓬風，不用費力逍遙去，任意而行大亨通。\n\
這個卦是異卦（下坤上坎）相疊，坤為地；坎為水。水附大地，地納河海，互相依賴，親密無間。\n此卦與師卦完全相反，互為綜卦。它闡述的是相親相輔，寬宏無私，精誠團結的道理。",
  "小畜卦": "第9卦 風天小畜（小畜）\n\
蓄養待進 下卦\n\
象曰：苗逢旱天盡焦梢，水想雲濃雨不澆，農人仰面長籲籲，是從款來莫心高。\n\
這個卦是異卦（下乾上巽）相疊，乾為天；巽為風。喻風調雨順，穀物滋長，故卦名小畜（蓄）。\n力量有限，須待發展到一定程度，才可大有作為。",
  "履卦": "第10卦 天澤履（履）\n\
腳踏實地 中上卦\n\
象曰：鳳凰落在西歧山，去鳴幾聲出聖賢，天降文王開基業，富貴榮華八百年。\n\
這個卦是異卦（下兌上乾）相疊，乾為天；兌為澤，以天喻君，以澤喻民，原文：「履（踩）虎尾、不咥（咬）人。」因此，結果吉利。\n君上民下，各得其位。兌柔遇乾剛，所履危。履意為實踐，卦義是腳踏實地的向前進取的意思。",
  "泰卦": "第11卦 地天泰（泰）\n\
應時而變 中卦\n\
象曰：學文滿腹入場闈，三元及第得意回，從今解去愁和悶，喜慶平地一聲雷。\n\
這個卦是異卦（下乾上坤）相疊，乾為天，為陽；坤為地，為陰，陰陽交感，上下互通，天地相交，萬物紛紜。反之則兇。\n萬事萬物，皆對立，轉化，盛極必衰，衰而轉盛，故應時而變者泰（通）。",
  "否卦": "第12卦 天地否（否）\n\
不交不通 中卦\n\
象曰：虎落陷坑不堪言，進前容易退後難，謀望不遂自己便，疾病口舌事牽連。\n\
這個卦是異卦（下坤上乾）相疊，其結構同泰卦相反，系陽氣上升，陰氣下降，天地不交，萬物不通。\n它們彼此為“綜卦”，表明泰極而否，否極泰來，互為因果。",
  "同人卦": "第13卦 天火同人（同人）\n\
上下和同 上卦\n\
象曰：心中有事犯猜疑，謀望從前不著實，幸遇明人來指引，諸般憂悶自消之。\n\
這個卦是異卦（下離上乾）相疊，乾為天，為君；離為火，為臣民百姓，上天下火，火性上升，同於天，上下和同，同舟共濟，人際關係和諧，天下大同。",
  "大有卦": "第14卦 火天大有（大有）\n\
順天依時 上上卦\n\
象曰：砍樹摸雀作事牢，是非口舌自然消，婚姻合夥來費力，若問走失未逃脫。\n\
這個卦是異卦（下乾上離）相疊。上卦為離，為火；下卦為乾，為天。火在天上，普照萬物，萬民歸順，順天依時，大有所成。",
  "謙卦": "第15卦 地山謙（謙）\n\
內高外低 中卦\n\
象曰：天賜貧人一封金，不爭不搶兩平分，彼此分得金到手，一切謀望皆遂心。\n\
這個卦是異卦（下根上坤）相疊，根為山，坤為地。地面有山，地卑（低）而山高，是為內高外低，比喻功高不自居，名高不自譽，位高不自傲。這就是謙。",
  "豫卦": "第16卦 雷地豫（豫）\n\
順時依勢 中卦\n\
象曰：太公插下杏黃旗，收妖為徒歸西歧，自此青龍得了位，一旦謀望百事宜。\n\
這個卦是異卦（下坤上震）相疊，坤為地，為順；震為雷，為動。雷依時出，預示大地回春。\n因順而動，和樂之源。此卦與謙卦互為綜卦，交互作用。",
  "隨卦": "第17卦 澤雷隨（隨）\n\
隨時變通 中卦\n\
象曰：泥裡步踏這幾年，推車靠崖在眼前，目下就該再使力，扒上崖去發財源。\n\
這個卦是異卦（下震上兌）相疊，震為雷、為動；兌為悅。動而悅就是「隨」。\n隨指相互順從，己有隨物，物能隨己，彼此溝通。隨必依時順勢，有原則和條件，以堅貞為前提。",
  "蠱卦": "第18卦 山風蠱（蠱）\n\
振疲起衰 中卦\n\
象曰：卦中爻像如推磨，順從為福反為禍，心中有益且遲遲，凡事盡從忙處錯。\n\
這個卦是異卦（下巽上根）相疊，與隨卦互為綜卦。蠱（gu）本意為事，引申為多事、混亂。\n器皿久不用而生蟲稱“蠱”，喻天下久安而因循、腐敗，必須革新創造，治理整頓，挽救危機，重振事業。",
  "臨卦": "第19卦 地澤臨（臨）\n\
教民保民 上卦\n\
象曰：君王無道民倒懸，常想撥雲見青天，幸逢明主施仁政，重又安居樂自然。\n\
這個卦是異卦（下兌上坤）相疊。坤為地；兌為澤，地高於澤，澤容於地。\n喻君主親臨天下，治國安邦，上下融洽。",
  "觀卦": "第20卦 風地觀（觀）\n\
觀下瞻上 中上卦\n\
象曰：卦遇蓬花旱逢河，生意買賣利息多，婚姻自有人來助，出門永不受折磨。\n\
這個卦是異卦（下坤上巽）相疊，風行地上，喻德教遍施。觀卦與臨卦互為綜卦，交相使用。\n在上者以道義觀天下；在下者以敬仰瞻上，人心順服歸從。",
  "噬嗑卦": "第21卦 火雷噬嗑（噬嗑）\n\
剛柔相濟 上上卦\n\
象曰：運拙如同身受飢，幸得送飯又送食，適口充腹心歡喜，憂愁從此漸消移。\n\
這個卦是異卦（下震上離）相疊。離為陰卦；震為陽卦。\n陰陽相交，咬碎硬物，喻恩威並施，寬嚴結合，剛柔相濟。噬嗑（shihe）為上下顎咬合，咀嚼。",
  "賁卦": "第22卦 山火賁（賁）\n\
飾外揚質 中上卦\n\
象曰：近來運轉銳氣週，窈窕淑女君子求，鐘鼓樂之大吉慶，佔者逢之喜臨頭。\n\
這個卦是異卦（下離上根）相疊。離為火為明；艮為山為止。文明而有節制。\n賁（bi）卦論述文與質的關係，以質為主，以文調節。賁，文飾、修飾。",
  "剝卦": "第23卦 山地剝（剝）\n\
順勢而止 中下卦\n\
象曰：鵲遇天晚宿林中，不知林內先有鷹，雖然同處心生惡，卦若逢之是非輕。\n\
這個卦是異卦（下坤上根）相疊。五陰在下，一陽在上，陰盛陽孤；高山附於地。\n二者都是剝落象，故為「剝卦」。此卦陰盛陽衰，喻小人得勢，君子困頓，事業敗壞。",
  "復卦": "第24卦 地雷複（複）\n\
寓動於順 中卦\n\
象曰：馬氏太公不相合，世人佔之憂疑多，恩人無義反為怨，是非平地起風波。\n\
這個卦是異卦（下震上坤）相疊。震為雷、為動；坤為地、為順，動則順，順其自然。\n動在順中，內陽外陰，循序運動，進退自如，利於前進。",
   "無妄卦": "第25卦 天雷無妄（無錯誤）\n\
妄而得 下卦\n\
象曰：飛鳥失機落籠中，縱然奮飛不能騰，目下只宜守本分，妄想扒高萬不能。\n\
這個卦是異卦（下震上乾）相疊。乾為天為剛為健；震為雷為剛為動。\n動而健，剛陽盛，人心振奮，必有所得，但唯循純正，不可妄行。無妄必有獲，必可致福。",
  "大畜卦": "第26卦 山天大畜（大畜）\n\
止而不止 中上卦\n\
象曰：憂愁常鎖兩眉頭，千頭萬緒掛心間，從今以後防開陣，任意行而不相干。\n\
這個卦是異卦（下乾上根）相疊。乾為天，剛健；艮為山，篤實。\n畜者積聚，大畜意為大積蓄。為此不畏嚴重的艱難險阻，努力修身養性以豐富德業。",
  "頤卦": "第27卦 山雷頤（頤）\n\
純正以養 上上卦\n\
象曰：太公獨釣渭水河，手持絲桿憂愁多，時來又遇文王訪，自此永不受折磨。\n\
這個卦是異卦（下震上根）相疊。震為雷，艮為山。山在上而雷在下，外實內虛。\n春暖萬物養育，依時養賢育民。陽實陰虛，實者養人，虛者為人養。自食其力。",
  "大過卦": "第28卦 澤風大過（大過）\n\
非常行動 中下卦\n\
象曰：夜晚夢裡夢金銀，醒來仍不見一文，目下只宜求本分，思想絡是空勞神。\n\
這個卦是異卦（下巽上兌）相疊。兌為澤、為悅，巽為木、為順，澤水淹舟，遂成大錯。\n陰陽爻相反，陽大陰小，行動非常，有過度形象，內剛外柔。",
  "坎卦": "第29卦 坎為水（坎）\n\
行險用險 下卦\n\
象曰：一輪明月照水中，只見影兒不見蹤，愚夫當財下去取，摸來摸去一場空。\n\
這個卦是同卦（下坎上坎）相疊。坎為水、為險，兩坎相重，險上加險，險阻重重。\n一陽陷二陰。所幸陰虛陽實，誠信可豁然貫通。雖險難重重，卻方能顯人性光彩。",
  "離卦": "第30卦 離為火（離）\n\
附和依托 中上卦\n\
象曰：官人來佔主高升，莊農人家產業增，生意買賣利息厚，匠藝佔之大亨通。\n\
這個卦是同卦（下離上離）相疊。離者麗也，附著之意，一陰附麗，上下二陽，該卦象徵火，內空外明。\n離為火、為明、太陽反覆升落，運作不息，柔順為心。",
  "咸卦": "第31卦 澤山鹹（鹹）\n\
相互感應 中上卦\n\
象曰：運去黃金失色，時來棒槌發芽，月令極佳無差，且喜心寬意大。\n\
這個卦是異卦（下根上兌）相疊。艮為山；澤為水。兌柔在上，根根在下，水向下滲，柔上而剛下，交相感應。感則成。",
  "恆卦": "第32卦 雷風恆（恆）\n\
恆心有成 中上卦\n\
象曰：漁翁尋魚運氣好，魚來撞網跑不了，別人使本掙不來，誰想一到就湊合。\n\
這個卦是異卦（下巽上震）相疊。震為男、為雷；巽為女、為風。震剛在上，巽柔在下。\n剛上柔下，造化有常，相互助長。陰陽相應，常情，故稱為恆。",
  "遯卦": "第33卦 天山遁（遁）\n\
遁世救世 下下卦\n\
象曰：濃雲蔽日不光明，勸君且莫出遠行，婚姻求財皆不利，提防口舌到門庭。\n\
這個卦是異卦（下根上乾）相疊。乾為天，艮為山。天下有山，山高天退。陰長陽消，小人得勢，君子退隱，明哲保身，伺機救天下。",
  "大壯卦": "第34卦 雷天大壯（大壯）\n\
壯勿妄動 中上卦\n\
象曰：卦佔工師得大木，眼前該著走上路，時來運轉多順當，有事自管放心寬。\n\
這個卦是異卦（下乾上震）相疊。震為雷；乾為天。乾剛震動。天鳴雷，雲雷滾，聲勢宏大，陽氣盛壯，萬物生長。\n剛壯有力故曰壯。大而且壯，故名大壯。四陽壯盛，積極而有所作為，上正下正，標正影直。",
  "晉卦": "第35卦 火地晉（晉）\n\
求進發展 中上卦\n\
象曰：鋤地鋤去苗裡草，誰想財帛將人找，一鋤鋤出銀子來，這個運氣也算好。\n\
這個卦是異卦（下坤上離）相疊。離為日，為光明；坤為地。\n太陽高懸，普照大地，大地卑順，萬物生長，光明磊落，柔進上行，喻事業蒸蒸日上。",
  "明夷卦": "第36卦 地火明夷（明夷）\n\
晦而轉明 中下卦\n\
象曰：時乖運拙走不著，急忙過河拆了橋，恩人無義反為怨，凡事無功枉受勞。\n\
這個卦是異卦（下離上坤）相疊。離為明，坤為順；離為日；坤為地。\n日沒入地，光明受損，前途不明，環境困難，宜遵時養晦，堅守正道，外愚內慧，韜光養晦。",
  "家人卦": "第37卦 風火家人（家人）\n\
誠威治業 下卦\n\
象曰：一朵花鏡中開，看著極好取不來，勸君休把鏡花戀，卦若逢之主可怪。\n\
這個卦是異卦（下離上巽）相疊。離為火；巽為風。火使熱氣上升，成為風。\n一切事物應以內在為本，然後伸延到外。發生於內，形成於外。喻先治家而後治天下，家道正，天下安樂。",
  "睽卦": "第38卦 火澤睽（睽）\n\
異中求同 下卦\n\
象曰：此卦佔來運氣歹，如同太公作買賣，販豬牛快販羊遲，豬羊齊販賣了宰。\n\
這個卦是異卦（下兌上離）相疊。離為火；兌為澤。上火下澤，相違不相濟。\n克則生，往復無空。萬物有所不同，必有所異，互相矛盾。睽即矛盾。",
  "蹇卦": "第39卦 水山蹇（蹇）\n\
險阻在前 下卦\n\
象曰：大雨傾地雪滿天，路上行人苦又寒，拖泥帶水費盡力，事不遂心且耐煩。\n\
這個卦是異卦（下根上坎）相疊。坎為水，根為山。\n山高水深，困難重重，人生險阻，見險而止，明哲保身，可謂智慧。蹇，跋行艱。",
  "解卦": "第40卦 雷水解（解）\n\
柔道致治 中上卦\n\
象曰：目下月令如過關，千辛萬苦受熬煎，時來恰相有人救，任意所為不相干。\n\
這個卦是異卦（下坎上震）相疊。震為雷、為動；坎為水、為險。\n險在內，動在外。嚴冬天地閉塞，靜極而動。萬象更新，冬去春來，一切消除，是為解。",
  "損卦": "第41卦 山澤損（損）\n\
損益制衡 下卦\n\
象曰：時動不至費心多，比喻推車受折磨，山路崎嶇吊下耳，做插右按按不著。\n\
這個卦是異卦（下兌上根）相疊。艮為山；兌為澤。上山下澤，大澤浸蝕山根。損益相間，損中有益，益中有損。\n二者之間，不可不慎重對待。損下益上，治理國家，過度會損傷國基。應損則損，但必量力、適度。少損而益最佳。",
  "益卦": "第42卦 風雷益（益）\n\
損上益下 上上卦\n\
象曰：時來運轉吉氣發，多年枯木又開花，枝葉重生多茂盛，幾人見了幾人誇。\n\
這個卦是異卦（下震上巽）相疊。巽為風；震為雷。風雷激盪，其勢愈強，雷愈響，風雷相助互長，交相助益。\n此卦與損卦相反。它是損上以益下，後者是損下以益上。二卦闡述的是損益的原則。",
  "夬卦": "第43卦 澤天夬 （夬）\n\
決而能和 上上卦\n\
象曰：蜘蛛脫網賽天軍，黏住遊蜂翅翎毛，幸有大風吹破網，脫離災難又逍遙。\n\
這個卦是異卦（下乾上兌）相疊。乾為天為健；兌為澤為悅。\n澤氣上升，決注成雨，雨施大地，滋潤萬物。五陽去一陰，去之不難，決（去之意）即可，故名為夬（guài），夬即決。",
  "姤卦": "第44卦 天風姤（姤）\n\
天下有風 上卦\n\
象曰：他鄉遇友喜氣歡，須知運氣福重添，自今交了順當運，向後管保不相干。\n\
這個卦是異卦（下巽上乾）相疊。乾為天，巽為風。天下有風，吹遍大地，陰陽交合，萬物茂盛。\n姤（gǒu）卦與夬卦相反，互為「綜卦」。姤即遘，陰陽相遇。但五陽一陰，不能長久相處。",
  "萃卦": "第45卦 澤地萃（萃）\n\
薈萃聚集 中上卦\n\
象曰：遊魚戲水被網驚，跳過龍門身化龍，三尺楊柳垂金錢，萬朵桃花顯你能。\n\
這個卦是異卦相疊（下坤上兌）。坤為地、為順；兌為澤、為水。\n澤氾濫淹沒大地，人眾多相互鬥爭，危機必四伏，務必順天任賢，未雨綢繆，柔順而又和悅，彼此相得益彰，安居樂業。萃，聚集、團結。",
  "升卦": "第46卦 地風升（升）\n\
柔順謙虛 上上卦\n\
象曰：士人來佔必得名，生意買賣也興隆，匠藝逢之交易好，農間莊稼亦收成。\n\
這個卦是異卦相疊（下巽上坤）。坤為地、為順；巽為木、為遜。\n大地生長樹木，逐的成長，日漸高大成材，喻事業步步高升，前程遠大，故名「升」。",
  "困卦": "第47卦 澤水困（困）\n\
困境求通 中上卦\n\
象曰：時運不來好傷懷，撮上押去把梯抬，一筒蟲翼無到手，轉了上去下不來。\n\
這個卦是異卦（下坎上兌）相疊。兌為陰為澤喻悅；坎為陽為水喻險。\n澤水困，陷入困境，才智難以施展，仍堅守正道，自得其樂，必可成事，擺脫困境。",
  "井卦": "第48卦 水風井（井）\n\
求賢若渴 上上卦\n\
象曰：枯井破費已多年，一朝流泉出來鮮，資生濟渴人稱羨慕，時來運轉喜自然。\n\
這個卦是異卦（下巽上坎）相疊。坎為水；巽為木。樹木得水而蓬勃生長。\n人靠水井生活，水井由人挖掘而成。相互為養，井以水養人，經久不竭，人應取此德而勤勞自勉。",
  "革卦": "第49卦 澤火革（革）\n\
順天應人 上上卦\n\
象曰：苗逢旱天漸漸衰，幸得天恩降雨來，憂去喜來能變化，求謀幹事遂心懷。\n\
這個卦是異卦（下離上兌）相疊。離為火、兌為澤，澤內有水。水在上而下澆，火在下而上升。\n火旺水乾；水大火熄。二者相生亦相剋，必然出現變革。變革是宇宙的基本法則。",
  "鼎卦": "第50卦 火風鼎（鼎）\n\
穩重圖變 中下卦\n\
象曰：鶯鶓蛤蜊落沙灘，蛤蜊鶯鶓兩翅扇，漁人進前雙得利，失走行人卻自在。\n\
這個卦是異卦（下巽上離）相疊。燃木煮食，化生為熟，除舊布新的意思。\n鼎為重寶大器，三腳穩重之象。煮食，喻食物充足，不再有困難和困擾。在此基礎上宜變革，發展事業。",
  "震卦": "第51卦 震為雷（震）\n\
臨危不亂 中上卦\n\
象曰：一口金鐘在淤泥，人人拿著當玩石，忽然一日鐘懸起，響亮一聲天下知。\n\
這個卦是同卦（下震上震）相疊。震為雷，兩震相疊，反應巨大，可消除沉悶之氣，亨通暢達。\n平日應居安思危，懷恐懼心理，不敢有所怠慢，遇到突發事變，也能安然自若，談笑如常。",
  "艮卦": "第52卦 艮為山（根）\n\
動靜適時 中下卦\n\
象曰：財帛常打心頭走，可惜眼前難到手，不如意時且忍耐，逢著閒事休開口。\n\
這個卦是同卦（下根根）相疊。艮為山，二山相重，喻靜止。它和震卦相反。高潮過後，必然出現低潮，進入事物的相對靜止階段。\n靜止如山，宜止則止，宜行則行。行止即動和靜，都不可失機，應恰到好處，動靜得宜，適可而止。",
  "漸卦": "第53卦 風山漸（漸）\n\
漸進蓄德 上上卦\n\
象曰：俊鳥幸得出籠中，脫離災難顯威風，一朝得意福力至，東西南北任意行。\n\
這個卦是異卦（下根上巽）相疊。艮為山，巽為木。山上有木，逐漸成長，山也隨著增高。\n這是逐漸進步的過程，所以稱漸，漸即進，漸漸前進而不急速。",
  "歸妹卦": "第54卦 雷澤歸妹（歸妹）\n\
立家興業 下下卦\n\
象曰：求魚須當向水中，樹上求之不順情，受盡爬揭難隨意，勞而無功運平平。\n\
這個卦是異卦（下兌上震）相疊。震為動、為長男；兌為悅、為少女。以少女從長男，產生愛慕之情，有婚姻之動，有嫁女之象，故稱歸妹。男婚女嫁，天地大義，人的開始與終結。\n上卦與漸卦為綜卦，交互為用。",
  "豐卦": "第55卦 雷火豐（豐）\n\
日中則斜 上卦\n\
象曰：古鏡昏暗好幾年，一朝磨明似月圓，君子謀事逢此卦，近來運轉喜自然。\n\
這個卦是異卦（下離上震）相疊，電閃雷鳴，成就巨大，喻達到頂峰，如日中天。\n告誡；務必注意事物朝相反方面發展。治亂相因，盛衰無常，不可不警惕。",
  "旅卦": "第56卦 火山旅（旅）\n\
依義順時 下卦\n\
象曰：飛鳥樹上壘窩巢，小人使計舉火燒，君佔此卦為不吉，一切謀望枉徒勞。\n\
這個卦是異卦（下根上離）相疊。此卦與豐卦相反，互為“綜卦”。\n山中燃火，燒而不止，火勢不停地向前蔓延，如同途中行人，急於趕路。因而稱旅卦。",
  "巽卦": "第57卦 巽為風（巽）\n\
謙遜受益 中上卦\n\
象曰：一葉孤舟落沙灘，有篙無水進退難，時逢大雨江湖溢，不用費力任往返。\n\
這個卦是同卦（下巽上巽）相疊，巽（xùn）為風，兩風相重，長風不絕，無孔不入，巽義為順。謙遜的態度和行為可無往不利。",
  "兌卦": "第58卦 兌為澤（澤）\n\
剛內柔外 上上卦\n\
象曰：這個卦象真可取，覺著做事不費力，休要錯過這機關，事事覺得隨心所欲。\n\
這個卦是同卦（下澤上澤）相疊。澤為水。兩澤相連，兩水交流，上下相和，團結一致，朋友相助，歡欣喜悅。兌為悅也。\n同秉剛健之德，外抱柔和之姿，堅行正道，導民向上。",
  "渙卦": "第59卦 風水渙（渙）\n\
拯救渙散 下下卦\n\
象曰：隔河望見一錠金，欲取岸寬水又深，指望資財難到手，盡夜資財枉費心。\n\
這個卦是異卦（下坎上巽）相疊。風在水上行，推波助瀾，四方流溢。渙，水流流散之意。\n象徵組織和人心渙散，必用積極的手段和方法克服，戰勝弊端，挽救渙散，危為安。",
  "節卦": "第60卦 水澤節（節）\n\
萬物有節 上上卦\n\
象曰：時來運轉喜氣生，登台封神姜太公，到此諸神皆退位，縱然有禍不成兇。\n\
這個卦是異卦（下兌上坎）相疊。兌為澤，坎為水。澤有水而流有限，多必溢於澤外。因此要有節度，故稱節。\n節卦與渙卦相反，互為綜卦，交相使用。天地有節度才能常新，國家有節度才能安穩，個人有節度才能完美。",
  "中孚卦": "第61卦 風澤中孚（中孚）\n\
誠信立身 下卦\n\
象曰：路上行人色匆匆，急忙無橋過薄冰，小心謹慎過得去，一步錯了落水中。\n\
這個卦是異卦（下兌上巽）相疊。孚（fú）本義孵，孵卵出殼的日期非常準確，有信的意義。\n卦形外實內虛，喻心中誠信，所以稱為中孚卦。這是立身處世的根本。",
  "小過卦": "第62卦 雷山小過（小過）\n\
行動有度 中上卦\n\
象曰：行人經過獨木橋，心內惶恐眼裡瞧，爽利保保過得去，慢行一定不安牢。\n\
這個卦是異卦（下根地震）相疊。艮為山，震為雷，過山雷鳴，不可不畏懼。\n陽為大，陰為小，卦外四陰超過中二陽，故稱“小過”，小有越過。",
  "既濟卦": "第63卦 水火既濟（既濟）\n\
盛極將衰 中上卦\n\
象曰：金榜以上題名，不負當年苦用功，人逢此卦名吉慶，一切謀望大亨通。\n\
這個卦是異卦（下離上坎）相疊。坎為水，離為火，水火相交，水在火上，水勢壓倒火勢，救火大功告成。\n既，已經；濟，成也。既濟就是事情已經成功，但終將發生變故。",
  "未濟卦": "第64卦 火水未濟（未濟）\n\
事業未竟 中下卦\n\
象曰：離地著人幾丈深，是防偷營劫寨人，後封太歲為兇煞，時加謹慎禍不侵。\n\
這個卦是異卦（下坎上離）相疊。離為火，坎為水。火上水下，火勢壓倒水勢，救火大功未成，故稱未濟。\n《周易》以乾坤二卦為始，以既濟、未濟二卦為終，充分反映了變化發展的想法。"
    # (添加更多解釋)
}
def show_instructions():
    # 創建新視窗顯示說明
    instruction_window = tk.Toplevel(root)
    instruction_window.title("易經銅錢卦的用法")
    instruction_window.geometry("600x400")
    
    instruction_text = """銅錢卦是一種傳統的易經占卜方法，通過投擲三枚銅錢來決定每爻的陰陽變化。
    
具體方法：
1. 先在心裡誠心詢問某件想占卜的事情
2. 程式中將准備三枚虛擬銅錢。
3. 將三枚銅錢同時投擲，一次決定一爻的變化。
4. 正面（陽）記作實線「——」，反面（陰）記作虛線 「－－」。
5. 從下往上共投擲六次，得到六個結果，組成一個六爻卦象。
6. 若某爻為變爻，則本卦轉變為變卦，變卦中該變爻會呈現相反的結果。
   如：本卦中的「老陰」，到變卦中則變為「老陽」。相反也是同理。
7. 根據最終的卦象來解讀結果。
8. 本卦說明了所詢問事件「現在的情況」，變卦則表示該事件「未來的發展」

這是一個古老的占卜方式，通過天、地、人三才的協調來尋找問題的答案。"""
    
    label = tk.Label(instruction_window, text=instruction_text, font=("Arial", 12), padx=10, pady=10, justify='left')
    label.pack(expand=True, fill=tk.BOTH)

    # 退出視窗的按鈕
    exit_button = tk.Button(instruction_window, text="關閉", command=instruction_window.destroy)
    exit_button.pack(pady=10)
    
# 投擲銅錢，返回爻（陰或陽）及其是否為變爻
def toss_coin():
    result = [random.choice(["正面", "反面"]) for _ in range(3)]
    count_heads = result.count("正面")
    if count_heads == 3:
        return "老陽", "陽", "yang"
    elif count_heads == 2:
        return "少陽", "陽", "yang"
    elif count_heads == 1:
        return "少陰", "陰", "yin"
    else:
        return "老陰", "陰", "yin"

# 將爻轉為二進制字符串
def get_trigram_code(tosses):
    return ''.join(['1' if line == "陽" else '0' for line in tosses])

# 解析六爻為上下卦
def get_hexagram_codes(tosses):
    lower_trigram = get_trigram_code(tosses[:3])  # 下卦 (後三條爻)
    upper_trigram = get_trigram_code(tosses[3:])  # 上卦 (前三條爻)
    return lower_trigram, upper_trigram

# 繪製卦象圖像
def draw_lines(canvas, lines_display, labels, start_x, start_y, spacing):
    for idx, (line, label) in enumerate(zip(lines_display, labels)):
        y = start_y - idx * spacing
        if line == "yang":
            canvas.create_line(start_x, y, start_x + 120, y, width=2)
        else:
            canvas.create_line(start_x, y, start_x + 50, y, width=2)
            canvas.create_line(start_x + 70, y, start_x + 120, y, width=2)
        # 顯示爻的名稱
        canvas.create_text(start_x + 150, y, text=f"({label})", font=("Arial", 10))

# 顯示本卦和變卦結果
def show_hexagrams():
    global tosses, changing_lines, lines_display_original, lines_display_changed, labels_original, original_hexagram_index, changed_hexagram_index

    # 計算變卦
    changed_tosses = []
    lines_display_changed = []  # 記錄變卦線條
    labels_changed = []
    for i, line in enumerate(tosses):
        if changing_lines[i]:
            # 老陽變為老陰，老陰變為老陽
            changed_tosses.append("陰" if line == "陽" else "陽")
            labels_changed.append("老陰" if labels_original[i] == "老陽" else "老陽")
        else:
            changed_tosses.append(line)
            labels_changed.append(labels_original[i])
        # 記錄變卦線條
        lines_display_changed.append("yin" if line == "陽" and changing_lines[i] else "yang" if line == "陰" and changing_lines[i] else "yang" if line == "陽" else "yin")
    
    changed_lower_code, changed_upper_code = get_hexagram_codes(changed_tosses)

    # 計算六十四卦中的編號
    original_hexagram_index = HEXAGRAM_NAMES.get((get_trigram_code(tosses[3:])+ get_trigram_code(tosses[:3])))
    changed_hexagram_index = HEXAGRAM_NAMES.get((changed_upper_code+ changed_lower_code))

    # 顯示本卦與變卦名稱，只顯示「乾、坤、震、艮、離、坎、兌、巽」，並且加上64卦的編號
    hexagram_display.set(f"本卦: 下卦 {TRIGRAM_NAMES.get(get_trigram_code(tosses[:3]))}, 上卦 {TRIGRAM_NAMES.get(get_trigram_code(tosses[3:]))} ({original_hexagram_index})\n"
                         f"變卦: 下卦 {TRIGRAM_NAMES.get(changed_lower_code)}, 上卦 {TRIGRAM_NAMES.get(changed_upper_code)} ({changed_hexagram_index})")
    
    # 繪製本卦和變卦線條
    draw_lines(canvas, lines_display_original, labels_original, 50, 400, 20)  # 繪製本卦
    draw_lines(canvas, lines_display_changed, labels_changed, 230, 400, 20)  # 繪製變卦

    # 在本卦和變卦下方添加標籤，並拉開兩組的距離
    canvas.create_text(110, 450, text="本卦", font=("Arial", 12))
    canvas.create_text(290, 450, text="變卦", font=("Arial", 12))

# 重置遊戲
def reset_game():
    global tosses, changing_lines, lines_display_original, lines_display_changed, labels_original
    tosses = []
    changing_lines = []
    lines_display_original = []
    lines_display_changed = []
    labels_original = []
    display_toss.set("")
    hexagram_display.set("")
    canvas.delete("all")
    start_frame.pack()
    result_frame.pack_forget()
    interpretation_button.pack_forget()
    retry_button.pack_forget()
    toss_button.config(state=tk.NORMAL)
    
def show_interpretation():
    # 創建新視窗顯示卦象解析
    global original_hexagram_index, changed_hexagram_index
    interpretation_window = tk.Toplevel(root)
    interpretation_window.title("卦象解析")
    interpretation_window.geometry("1920x1080")
    
    label = tk.Label(interpretation_window, text=f"本卦: {HEXAGRAM_INTERPRETATIONS.get(original_hexagram_index)}\n\n"
                         f"變卦: {HEXAGRAM_INTERPRETATIONS.get(changed_hexagram_index)}", font=("Arial", 12), padx=10, pady=10, justify='left')
    label.pack(expand=True, fill=tk.BOTH)

# 投擲過程並顯示結果
def toss_and_show():
    global tosses, changing_lines, lines_display_original, labels_original
    if len(tosses) < 6:
        result, final_line, visual_line = toss_coin()
        tosses.append(final_line)
        if result in ["老陽", "老陰"]:
            changing_lines.append(True)
        else:
            changing_lines.append(False)

        for _ in range(10):
            display_toss.set("投擲中...")
            root.update()
            time.sleep(0.05)
            display_toss.set("")
            root.update()
            time.sleep(0.05)

        display_toss.set(f"第{len(tosses)}次投擲結果：{result}")
        labels_original.append(result)  # 添加每條線的描述
        lines_display_original.append(visual_line)
        draw_lines(canvas, lines_display_original, labels_original, 120, 200, 20)

    if len(tosses) == 6:
        show_hexagrams()
        toss_button.config(state=tk.DISABLED)
        interpretation_button.pack(pady=10)
        retry_button.pack(pady=10)

def start_game():
    start_frame.pack_forget()
    result_frame.pack()
    toss_button.pack(pady=10)
    result_label.pack(pady=5)

root = tk.Tk()
root.title("易經起卦")
root.geometry("450x500")

tosses = []
changing_lines = []
lines_display_original = []
lines_display_changed = []
labels_original = []

display_toss = tk.StringVar()
hexagram_display = tk.StringVar()
interpretation_display = tk.StringVar()

# 開始頁面
start_frame = tk.Frame(root)
start_button = tk.Button(start_frame, text="開始測試", command=start_game)
start_button.pack(pady=150)
# 添加"算卦說明"按鈕
instruction_button = tk.Button(start_frame, text="算卦說明", command=show_instructions)
instruction_button.pack(pady=20)
start_frame.pack()

# 結果頁面
result_frame = tk.Frame(root)
toss_button = tk.Button(result_frame, text="投擲銅錢", command=toss_and_show)
result_label = tk.Label(result_frame, textvariable=display_toss)

canvas = tk.Canvas(result_frame, width=450, height=500)
canvas.pack(pady=10)

# 本卦、變卦及投擲中的標籤
hexagram_label = tk.Label(result_frame, textvariable=hexagram_display, font=("Arial", 12))
hexagram_label.pack(pady=10)

# 新增的卦象解析標籤

interpretation_button = tk.Button(root, text="卦象解析",command=show_interpretation)
retry_button = tk.Button(root, text="再測一次", command=reset_game)

root.mainloop()
